<!DOCTYPE html>

<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maison • Organisation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-100 via-violet-100 to-blue-200 min-h-screen">

<div id="app" class="max-w-md mx-auto p-4 pb-24">

  <!-- Header -->

  <header class="mb-6">
    <h1 class="text-2xl font-bold text-blue-900">Aujourd’hui</h1>
    <p id="today" class="text-sm text-blue-700"></p>
  </header>

  <!-- Progress -->

  <div class="bg-white/80 rounded-2xl p-4 shadow mb-6">
    <p class="text-sm text-gray-600 mb-2">Progression du jour</p>
    <div class="w-full h-3 bg-gray-200 rounded-full overflow-hidden">
      <div id="progressBar" class="h-full bg-gradient-to-r from-violet-400 to-blue-500" style="width:0%"></div>
    </div>
  </div>

  <!-- Tasks -->

  <section class="space-y-3" id="tasks"></section>

  <!-- Agenda -->

  <section class="mt-8">
    <h2 class="text-lg font-semibold text-blue-900 mb-3">Agenda</h2>
    <div id="events" class="space-y-2"></div>
    <button onclick="openEventModal()" class="mt-4 w-full py-3 rounded-xl bg-violet-600 text-white font-semibold">➕ Ajouter un rendez-vous</button>
  </section>
</div>

<!-- Bottom Nav -->

<nav class="fixed bottom-4 left-4 right-4 bg-white/90 backdrop-blur rounded-full shadow flex justify-around py-2">
  <span class="font-semibold text-blue-700">Accueil</span>
  <span class="text-gray-400">Tâches</span>
  <span class="text-gray-400">Agenda</span>
</nav>

<!-- Modal -->

<div id="eventModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl p-6 w-full max-w-sm space-y-3">
    <h3 class="font-bold text-lg">Nouveau rendez-vous</h3>
    <input id="evTitle" placeholder="Titre" class="w-full border p-2 rounded" />
    <input id="evDate" type="date" class="w-full border p-2 rounded" />
    <input id="evTime" type="time" class="w-full border p-2 rounded" />
    <div class="flex justify-between">
      <button onclick="closeEventModal()" class="px-4 py-2 rounded bg-gray-200">Annuler</button>
      <button onclick="addEvent()" class="px-4 py-2 rounded bg-blue-600 text-white">Ajouter</button>
    </div>
  </div>
</div>

<script>
// Date
document.getElementById('today').innerText = new Date().toLocaleDateString('fr-FR', { weekday:'long', day:'numeric', month:'long' })

// Data
let tasks = JSON.parse(localStorage.getItem('tasks')) || [
  { id:1, label:'Nettoyer la cuisine', done:false },
  { id:2, label:'Lancer une lessive', done:false },
  { id:3, label:'Ranger le salon', done:false }
]

let events = JSON.parse(localStorage.getItem('events')) || []

function save() {
  localStorage.setItem('tasks', JSON.stringify(tasks))
  localStorage.setItem('events', JSON.stringify(events))
}

function renderTasks() {
  const container = document.getElementById('tasks')
  container.innerHTML = ''
  tasks.forEach(t => {
    const div = document.createElement('div')
    div.className = 'bg-white/80 rounded-xl p-4 flex justify-between items-center shadow'
    div.innerHTML = `
      <span class="${t.done?'line-through text-gray-400':''}">${t.label}</span>
      <input type="checkbox" ${t.done?'checked':''} />
    `
    div.querySelector('input').onchange = () => toggleTask(t.id)
    container.appendChild(div)
  })
  updateProgress()
}

function toggleTask(id) {
  const t = tasks.find(x=>x.id===id)
  t.done = !t.done
  save()
  renderTasks()
  if(t.done) confetti({ spread:120, particleCount:60 })
}

function updateProgress() {
  const done = tasks.filter(t=>t.done).length
  const pct = Math.round((done/tasks.length)*100)
  document.getElementById('progressBar').style.width = pct+'%'
}

function renderEvents() {
  const c = document.getElementById('events')
  c.innerHTML = ''
  events.forEach(e=>{
    const d = document.createElement('div')
    d.className='bg-white/80 rounded-xl p-3 shadow text-sm'
    d.innerText = `${e.date} ${e.time||''} • ${e.title}`
    c.appendChild(d)
  })
}

function openEventModal(){ document.getElementById('eventModal').classList.remove('hidden') }
function closeEventModal(){ document.getElementById('eventModal').classList.add('hidden') }

function addEvent(){
  events.push({
    title: evTitle.value,
    date: evDate.value,
    time: evTime.value
  })
  save(); renderEvents(); closeEventModal()
}

renderTasks(); renderEvents();
</script>

</body>
</html>
